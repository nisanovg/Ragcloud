---
title: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å Managed Redis¬Æ
source: Cloud.ru Evolution Tutorials
url: https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance
topic: database
---
# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å Managed Redis¬Æ

–° –ø–æ–º–æ—â—å—é —ç—Ç–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –≤—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–µ—Ä–≤–∏—Å–∞ Managed Redis¬Æ.
–í—ã —Å–æ–∑–¥–∞–¥–∏—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç–µ —Å–µ—Ä–≤–∏—Å Managed Redis¬Æ, —Å–æ–µ–¥–∏–Ω–∏—Ç–µ –µ–≥–æ —Å Web-—Å–µ—Ä–≤–∏—Å–æ–º –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –∏ Managed PostgreSQL¬Æ, –∞ –∑–∞—Ç–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç–µ Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Fast API —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
–¢–∞–∫–∂–µ —Å–æ–∑–¥–∞–¥–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É Ubuntu 22.04 –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ Grafana k6.
–í –∫–æ–Ω—Ü–µ —Å—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –±–µ–∑.

–í—ã –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã:

- [–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã](https://cloud.ru/docs/virtual-machines/ug/index)–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã ‚Äî —Å–µ—Ä–≤–∏—Å, –≤ —Ä–∞–º–∫–∞—Ö –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞.
- [Managed Redis](https://cloud.ru/docs/redis/ug/index)Managed Redis ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.
- [–ü—É–±–ª–∏—á–Ω—ã–π IP-–∞–¥—Ä–µ—Å](https://cloud.ru/docs/public-ip/ug/topics/guides__allocate-ip)–ü—É–±–ª–∏—á–Ω—ã–π IP-–∞–¥—Ä–µ—Å ‚Äî –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–∏—Å—É —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.
- [VPC](https://cloud.ru/docs/evolution-vpc/ug/index)VPC ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.
- [Grafana k6](https://k6.io/)Grafana k6 ‚Äî —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

[–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã](https://cloud.ru/docs/virtual-machines/ug/index)–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã ‚Äî —Å–µ—Ä–≤–∏—Å, –≤ —Ä–∞–º–∫–∞—Ö –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞.

[Managed Redis](https://cloud.ru/docs/redis/ug/index)Managed Redis ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.

[–ü—É–±–ª–∏—á–Ω—ã–π IP-–∞–¥—Ä–µ—Å](https://cloud.ru/docs/public-ip/ug/topics/guides__allocate-ip)–ü—É–±–ª–∏—á–Ω—ã–π IP-–∞–¥—Ä–µ—Å ‚Äî –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–∏—Å—É —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.

[VPC](https://cloud.ru/docs/evolution-vpc/ug/index)VPC ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

[Grafana k6](https://k6.io/)Grafana k6 ‚Äî —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

–®–∞–≥–∏:

1. [–†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã –≤ –æ–±–ª–∞–∫–µ](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã –≤ –æ–±–ª–∞–∫–µ.
2. [–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ.
3. [–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è.
4. [–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
5. [–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º.
6. [–£–¥–∞–ª–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–£–¥–∞–ª–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

[–†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã –≤ –æ–±–ª–∞–∫–µ](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã –≤ –æ–±–ª–∞–∫–µ.

[–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ.

[–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è.

[–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

[–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

[–£–¥–∞–ª–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](https://cloud.ru/docs/tutorials-evolution/list/topics/managed-redis__web-performance)–£–¥–∞–ª–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

## –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã

1. [–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ Cloud.ru](https://cloud.ru/docs/console/ug/topics/guides__registration)–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ Cloud.ru.
–ï—Å–ª–∏ –≤—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã, [–≤–æ–π–¥–∏—Ç–µ –ø–æ–¥ —Å–≤–æ–µ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é](https://cloud.ru/docs/console/ug/topics/guides__auth)–≤–æ–π–¥–∏—Ç–µ –ø–æ–¥ —Å–≤–æ–µ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é.
2. [–°–æ–∑–¥–∞–π—Ç–µ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ SSH-–∫–ª—é—á –≤ –æ–±–ª–∞–∫–æ](https://cloud.ru/docs/public-keys/ug/topics/guides__generate-key)–°–æ–∑–¥–∞–π—Ç–µ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ SSH-–∫–ª—é—á –≤ –æ–±–ª–∞–∫–æ.
3. [–†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ Web-—Å–µ—Ä–≤–∏—Å, –≤—ã–ø–æ–ª–Ω–∏–≤ —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–∑ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞](https://cloud.ru/docs/tutorials-evolution/list/topics/free-tier-vm__postgresql-connection)–†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ Web-—Å–µ—Ä–≤–∏—Å, –≤—ã–ø–æ–ª–Ω–∏–≤ —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–∑ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞.

[–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ Cloud.ru](https://cloud.ru/docs/console/ug/topics/guides__registration)–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ Cloud.ru.

–ï—Å–ª–∏ –≤—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã, [–≤–æ–π–¥–∏—Ç–µ –ø–æ–¥ —Å–≤–æ–µ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é](https://cloud.ru/docs/console/ug/topics/guides__auth)–≤–æ–π–¥–∏—Ç–µ –ø–æ–¥ —Å–≤–æ–µ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é.

[–°–æ–∑–¥–∞–π—Ç–µ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ SSH-–∫–ª—é—á –≤ –æ–±–ª–∞–∫–æ](https://cloud.ru/docs/public-keys/ug/topics/guides__generate-key)–°–æ–∑–¥–∞–π—Ç–µ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ SSH-–∫–ª—é—á –≤ –æ–±–ª–∞–∫–æ.

[–†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ Web-—Å–µ—Ä–≤–∏—Å, –≤—ã–ø–æ–ª–Ω–∏–≤ —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–∑ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞](https://cloud.ru/docs/tutorials-evolution/list/topics/free-tier-vm__postgresql-connection)–†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ Web-—Å–µ—Ä–≤–∏—Å, –≤—ã–ø–æ–ª–Ω–∏–≤ —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–∑ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞.

## 1. –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã –≤ –æ–±–ª–∞–∫–µ

–ù–∞ —ç—Ç–æ–º —à–∞–≥–µ –≤—ã —Å–æ–∑–¥–∞–¥–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –∏ –∫–ª–∞—Å—Ç–µ—Ä Managed Redis¬Æ –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

1. [–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É](https://cloud.ru/docs/virtual-machines/ug/topics/guides__create-vm)–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

–ù–∞–∑–≤–∞–Ω–∏–µ: k6-load-test.
–û–±—Ä–∞–∑: –ü—É–±–ª–∏—á–Ω—ã–µ ‚Üí Ubuntu 22.04.
–ú–µ—Ç–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: SSH-–∫–ª—é—á.
SSH-–∫–ª—é—á: –≤–∞—à SSH-–∫–ª—é—á.
–ò–º—è —Ö–æ—Å—Ç–∞: k6-load-test.
–ü–æ–¥–∫–ª—é—á–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π IP: –≤–∫–ª—é—á–µ–Ω–æ.
–¢–∏–ø IP-–∞–¥—Ä–µ—Å–∞: –ü—Ä—è–º–æ–π.
–ì—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: SSH-access_ru.AZ-1.
–ü–æ–¥—Å–µ—Ç—å: short-link-service-subnet.
–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–ª—è vCPU: 30%.
vCPU: 1.
RAM: 1.

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –≤ —Å–µ—Ä–≤–∏—Å–µ ¬´–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã¬ª –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ k6-load-test –≤ —Å—Ç–∞—Ç—É—Å–µ ¬´–ó–∞–ø—É—â–µ–Ω–∞¬ª.
2. [–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä Managed Redis](https://cloud.ru/docs/redis/ug/topics/guides__cluster-creation)–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä Managed Redis —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

–ù–∞–∑–≤–∞–Ω–∏–µ: short-links-cache.
–í–µ—Ä—Å–∏—è Redis: v7.2.11.
vCPU: 2.
RAM: 4.
–ü–æ–¥—Å–µ—Ç—å: short-link-service-subnet.

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –≤ —Å–µ—Ä–≤–∏—Å–µ Managed Redis¬Æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–ª–∞—Å—Ç–µ—Ä short-links-cache –≤ —Å—Ç–∞—Ç—É—Å–µ ¬´–î–æ—Å—Ç—É–ø–µ–Ω¬ª.

[–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É](https://cloud.ru/docs/virtual-machines/ug/topics/guides__create-vm)–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

- –ù–∞–∑–≤–∞–Ω–∏–µ: k6-load-test.
- –û–±—Ä–∞–∑: –ü—É–±–ª–∏—á–Ω—ã–µ ‚Üí Ubuntu 22.04.
- –ú–µ—Ç–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: SSH-–∫–ª—é—á.
- SSH-–∫–ª—é—á: –≤–∞—à SSH-–∫–ª—é—á.
- –ò–º—è —Ö–æ—Å—Ç–∞: k6-load-test.
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π IP: –≤–∫–ª—é—á–µ–Ω–æ.
- –¢–∏–ø IP-–∞–¥—Ä–µ—Å–∞: –ü—Ä—è–º–æ–π.
- –ì—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: SSH-access_ru.AZ-1.
- –ü–æ–¥—Å–µ—Ç—å: short-link-service-subnet.
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–ª—è vCPU: 30%.
- vCPU: 1.
- RAM: 1.

–ù–∞–∑–≤–∞–Ω–∏–µ: k6-load-test.

–û–±—Ä–∞–∑: –ü—É–±–ª–∏—á–Ω—ã–µ ‚Üí Ubuntu 22.04.

–ú–µ—Ç–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: SSH-–∫–ª—é—á.

SSH-–∫–ª—é—á: –≤–∞—à SSH-–∫–ª—é—á.

–ò–º—è —Ö–æ—Å—Ç–∞: k6-load-test.

–ü–æ–¥–∫–ª—é—á–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π IP: –≤–∫–ª—é—á–µ–Ω–æ.

–¢–∏–ø IP-–∞–¥—Ä–µ—Å–∞: –ü—Ä—è–º–æ–π.

–ì—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: SSH-access_ru.AZ-1.

–ü–æ–¥—Å–µ—Ç—å: short-link-service-subnet.

–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–ª—è vCPU: 30%.

vCPU: 1.

RAM: 1.

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –≤ —Å–µ—Ä–≤–∏—Å–µ ¬´–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã¬ª –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ k6-load-test –≤ —Å—Ç–∞—Ç—É—Å–µ ¬´–ó–∞–ø—É—â–µ–Ω–∞¬ª.

[–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä Managed Redis](https://cloud.ru/docs/redis/ug/topics/guides__cluster-creation)–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä Managed Redis —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

- –ù–∞–∑–≤–∞–Ω–∏–µ: short-links-cache.
- –í–µ—Ä—Å–∏—è Redis: v7.2.11.
- vCPU: 2.
- RAM: 4.
- –ü–æ–¥—Å–µ—Ç—å: short-link-service-subnet.

–ù–∞–∑–≤–∞–Ω–∏–µ: short-links-cache.

–í–µ—Ä—Å–∏—è Redis: v7.2.11.

vCPU: 2.

RAM: 4.

–ü–æ–¥—Å–µ—Ç—å: short-link-service-subnet.

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –≤ —Å–µ—Ä–≤–∏—Å–µ Managed Redis¬Æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–ª–∞—Å—Ç–µ—Ä short-links-cache –≤ —Å—Ç–∞—Ç—É—Å–µ ¬´–î–æ—Å—Ç—É–ø–µ–Ω¬ª.

## 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ

–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞.

1. [–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ k6-load-test –ø–æ SSH](https://cloud.ru/docs/virtual-machines/ug/topics/guides__ssh-connection)–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ k6-load-test –ø–æ SSH.
2. –û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã:
sudo apt update && sudo apt upgrade -ysudo apt install -y build-essential git curl unzip
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ NodeJS:
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -sudo apt install -y nodejs
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ k6:
sudo apt install -y gnupg ca-certificatescurl -fsSL https://dl.k6.io/key.gpg | sudo gpg --dearmor -o /usr/share/keyrings/k6-archive-keyring.gpgecho "deb [signed-by=/usr/share/keyrings/k6-archive-keyring.gpg] https://dl.k6.io/deb stable main" \ | sudo tee /etc/apt/sources.list.d/k6.listsudo apt updatesudo apt install -y k6
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É:
node -vk6 version

[–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ k6-load-test –ø–æ SSH](https://cloud.ru/docs/virtual-machines/ug/topics/guides__ssh-connection)–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ k6-load-test –ø–æ SSH.

–û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã:

```bash
sudo
apt
update
&&
sudo
apt
upgrade
-y
sudo
apt
install
-y
build-essential
git
curl
unzip
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ NodeJS:

```bash
curl
-fsSL
https://deb.nodesource.com/setup_18.x
|
sudo
-E
bash
-
sudo
apt
install
-y
nodejs
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ k6:

```bash
sudo
apt
install
-y
gnupg ca-certificates
curl
-fsSL
https://dl.k6.io/key.gpg
|
sudo
gpg
--dearmor
-o
/usr/share/keyrings/k6-archive-keyring.gpg
echo
"deb [signed-by=/usr/share/keyrings/k6-archive-keyring.gpg] https://dl.k6.io/deb stable main"
\
|
sudo
tee
/etc/apt/sources.list.d/k6.list
sudo
apt
update
sudo
apt
install
-y
k6
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É:

```bash
node
-v
k6 version
```

## 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

–ù–∞ —ç—Ç–æ–º —à–∞–≥–µ –≤—ã –ø—Ä–æ–≤–µ–¥–µ—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.

1. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ —Ñ–∞–π–ª —Ç–µ—Å—Ç–∞:
mkdir loadtestcd loadtestnano short-links.test.js
2. –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–µ—Å—Ç–∞, –∑–∞–º–µ–Ω–∏–≤ <IP-ADDRESS> –Ω–∞ –ø—É–±–ª–∏—á–Ω—ã–π IP-–∞–¥—Ä–µ—Å –≤–∞—à–µ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã short-links-service.
import http from 'k6/http';import { check, sleep } from 'k6';
export const options = { scenarios: { shortener_flow: { executor: 'constant-vus', vus: 10, duration: '1m' }, },};
const BASE = 'https://<IP-ADDRESS>.nip.io';
export default function () { const createPayload = JSON.stringify({ original_url: 'https://cloud.ru' }); const params = { headers: { 'Content-Type': 'application/json' } };
 const createRes = http.post(`${BASE}/shorten`, createPayload, params);
 check(createRes, { 'create - status 201/200': r => r.status === 201 || r.status === 200, 'create - has short_code': r => !!r.json('short_code'), });
 const shortCode = createRes.json('short_code'); const targetURL = `${BASE}/${shortCode}`;
 for (let i = 0; i < 20; i++) { const res = http.get(targetURL, { redirects: 0 }); check(res, { 'redirect status 302/301': r => r.status === 302 || r.status === 301, }); }
 sleep(1);}

–î–∞–Ω–Ω—ã–π –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É 10 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –≤ —Ç–µ—á–µ–Ω–∏–µ –æ–¥–Ω–æ–π –º–∏–Ω—É—Ç—ã —Å–æ–∑–¥–∞—é—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏ —á–µ—Ä–µ–∑ POST-–∑–∞–ø—Ä–æ—Å –∏ –∑–∞—Ç–µ–º –ø–æ 20 —Ä–∞–∑ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –∫–∞–∂–¥—É—é –ø–æ–ª—É—á–µ–Ω–Ω—É—é –∫–æ—Ä–æ—Ç–∫—É—é —Å—Å—ã–ª–∫—É, –ø—Ä–æ–≤–µ—Ä—è—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞.
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –∫–æ–º–∞–Ω–¥–æ–π:
k6 run short-links.test.js
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
‚ñà TOTAL RESULTS
 checks_total.......................: 1584 24.456932/s checks_succeeded...................: 100.00% 1584 out of 1584 checks_failed......................: 0.00% 0 out of 1584
 ‚úì create - status 201/200 ‚úì create - has short_code ‚úì redirect status 302/301
 HTTP http_req_duration.......................................................: avg=370.01ms min=19.25ms med=387.07ms max=622.41ms p(90)=453.49ms p(95)=483.84ms { expected_response:true }............................................: avg=370.01ms min=19.25ms med=387.07ms max=622.41ms p(90)=453.49ms p(95)=483.84ms http_req_failed.........................................................: 0.00% 0 out of 1512 http_reqs...............................................................: 1512 23.345253/s
 EXECUTION iteration_duration......................................................: avg=8.78s min=5.8s med=8.86s max=10.19s p(90)=9.85s p(95)=10.01s iterations..............................................................: 72 1.111679/s vus.....................................................................: 4 min=4 max=10 vus_max.................................................................: 10 min=10 max=10
 NETWORK data_received...........................................................: 341 kB 5.3 kB/s data_sent...............................................................: 172 kB 2.7 kB/s
running (1m04.8s), 00/10 VUs, 72 complete and 0 interrupted iterationsshortener_flow ‚úì [======================================] 10 VUs 1m0s

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ k6 –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–ø—Ä–∞–≤–∏–ª–∞—Å—å —Å –∑–∞—è–≤–ª–µ–Ω–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π: –≤—Å–µ 1584 –ø—Ä–æ–≤–µ—Ä–∫–∏ (¬´checks¬ª) –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫, –¥–æ–ª—è –Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî 0%, –∞ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ —Å–æ—Å—Ç–∞–≤–∏–ª–æ 370 –º—Å –ø—Ä–∏ –º–µ–¥–∏–∞–Ω–µ 387 –º—Å, –∏ –¥–∞–∂–µ –¥–ª—è 95% —Å–∞–º—ã—Ö ¬´–º–µ–¥–ª–µ–Ω–Ω—ã—Ö¬ª –∑–∞–ø—Ä–æ—Å–æ–≤ –≤—Ä–µ–º—è –Ω–µ –ø—Ä–µ–≤—ã—à–∞–ª–æ 484 –º—Å ‚Äî —ç—Ç–æ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏ –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ –∏–∑ 10 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

–°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ —Ñ–∞–π–ª —Ç–µ—Å—Ç–∞:

```bash
mkdir
loadtest
cd
loadtest
nano
short-links.test.js
```

–í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–µ—Å—Ç–∞, –∑–∞–º–µ–Ω–∏–≤ <IP-ADDRESS> –Ω–∞ –ø—É–±–ª–∏—á–Ω—ã–π IP-–∞–¥—Ä–µ—Å –≤–∞—à–µ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã short-links-service.

```bash
import
http
from
'k6/http'
;
import
{
check
,
sleep
}
from
'k6'
;
export
const
options
=
{
scenarios
:
{
shortener_flow
:
{
executor
:
'constant-vus'
,
vus
:
10
,
duration
:
'1m'
}
,
}
,
}
;
const
BASE
=
'https://<IP-ADDRESS>.nip.io'
;
export
default
function
(
)
{
const
createPayload
=
JSON
.
stringify
(
{
original_url
:
'https://cloud.ru'
}
)
;
const
params
=
{
headers
:
{
'Content-Type'
:
'application/json'
}
}
;
const
createRes
=
http
.
post
(
`
${
BASE
}
/shorten
`
,
createPayload
,
params
)
;
check
(
createRes
,
{
'create - status 201/200'
:
r
=>
r
.
status
===
201
||
r
.
status
===
200
,
'create - has short_code'
:
r
=>
!
!
r
.
json
(
'short_code'
)
,
}
)
;
const
shortCode
=
createRes
.
json
(
'short_code'
)
;
const
targetURL
=
`
${
BASE
}
/
${
shortCode
}
`
;
for
(
let
i
=
0
;
i
<
20
;
i
++
)
{
const
res
=
http
.
get
(
targetURL
,
{
redirects
:
0
}
)
;
check
(
res
,
{
'redirect status 302/301'
:
r
=>
r
.
status
===
302
||
r
.
status
===
301
,
}
)
;
}
sleep
(
1
)
;
}
```

–î–∞–Ω–Ω—ã–π –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É 10 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –≤ —Ç–µ—á–µ–Ω–∏–µ –æ–¥–Ω–æ–π –º–∏–Ω—É—Ç—ã —Å–æ–∑–¥–∞—é—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏ —á–µ—Ä–µ–∑ POST-–∑–∞–ø—Ä–æ—Å –∏ –∑–∞—Ç–µ–º –ø–æ 20 —Ä–∞–∑ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –∫–∞–∂–¥—É—é –ø–æ–ª—É—á–µ–Ω–Ω—É—é –∫–æ—Ä–æ—Ç–∫—É—é —Å—Å—ã–ª–∫—É, –ø—Ä–æ–≤–µ—Ä—è—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞.

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –∫–æ–º–∞–Ω–¥–æ–π:

```bash
k6 run short-links.test.js
```

–î–æ–∂–¥–∏—Ç–µ—Å—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:

```bash
‚ñà TOTAL RESULTS
checks_total
..
..
..
..
..
..
..
..
..
..
..
.:
1584
24.456932
/s
checks_succeeded
..
..
..
..
..
..
..
..
..
.:
100.00
%
1584
out of
1584
checks_failed
..
..
..
..
..
..
..
..
..
..
..
:
0.00
%
0
out of
1584
‚úì create - status
201
/200
‚úì create - has short_code
‚úì redirect status
302
/301
HTTP
http_req_duration
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
avg
=
370
.01ms
min
=
19
.25ms
med
=
387
.07ms
max
=
622
.41ms p
(
90
)
=
453
.49ms p
(
95
)
=
483
.84ms
{
expected_response:true
}
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
:
avg
=
370
.01ms
min
=
19
.25ms
med
=
387
.07ms
max
=
622
.41ms p
(
90
)
=
453
.49ms p
(
95
)
=
483
.84ms
http_req_failed
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
0.00
%
0
out of
1512
http_reqs
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
1512
23.345253
/s
EXECUTION
iteration_duration
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
:
avg
=
8
.78s
min
=
5
.8s
med
=
8
.86s
max
=
10
.19s p
(
90
)
=
9
.85s p
(
95
)
=
10
.01s
iterations
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
:
72
1.111679
/s
vus
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
4
min
=
4
max
=
10
vus_max
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
10
min
=
10
max
=
10
NETWORK
data_received
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
341
kB
5.3
kB/s
data_sent
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
172
kB
2.7
kB/s
running
(
1m04.8s
)
, 00/10 VUs,
72
complete and
0
interrupted iterations
shortener_flow ‚úì
[
==
==
==
==
==
==
==
==
==
==
==
==
==
==
==
==
==
==
==
]
10
VUs 1m0s
```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ k6 –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–ø—Ä–∞–≤–∏–ª–∞—Å—å —Å –∑–∞—è–≤–ª–µ–Ω–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π: –≤—Å–µ 1584 –ø—Ä–æ–≤–µ—Ä–∫–∏ (¬´checks¬ª) –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫, –¥–æ–ª—è –Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî 0%, –∞ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ —Å–æ—Å—Ç–∞–≤–∏–ª–æ 370 –º—Å –ø—Ä–∏ –º–µ–¥–∏–∞–Ω–µ 387 –º—Å, –∏ –¥–∞–∂–µ –¥–ª—è 95% —Å–∞–º—ã—Ö ¬´–º–µ–¥–ª–µ–Ω–Ω—ã—Ö¬ª –∑–∞–ø—Ä–æ—Å–æ–≤ –≤—Ä–µ–º—è –Ω–µ –ø—Ä–µ–≤—ã—à–∞–ª–æ 484 –º—Å ‚Äî —ç—Ç–æ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏ –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ –∏–∑ 10 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ù–∞ —ç—Ç–æ–º —à–∞–≥–µ –≤—ã –¥–æ–±–∞–≤–∏—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Redis –≤ –≤–∞—à–µ Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

1. [–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ short-links-service –ø–æ SSH](https://cloud.ru/docs/virtual-machines/ug/topics/guides__ssh-connection)–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ short-links-service –ø–æ SSH.
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
cd short-links-service
3. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
source venv/bin/activate
4. –ó–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ —Å–µ—Ä–≤–µ—Ä–∞ server.py –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Redis.
nano server.py

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:
import asyncioimport jsonimport osimport secretsimport stringimport threadingimport timefrom datetime import datetime
from dotenv import load_dotenvfrom fastapi import Depends, FastAPI, HTTPExceptionfrom fastapi.responses import RedirectResponsefrom pydantic import BaseModel, HttpUrlfrom sqlalchemy import Column, DateTime, Integer, String, create_enginefrom sqlalchemy.orm import Session, declarative_base, sessionmaker
# üî¥ redis (async, pooled)import redis.asyncio as redis # redis-py ‚â•5 provides asyncio & pooling
load_dotenv()
# -------------------------------------------------# Environment & external services# -------------------------------------------------DATABASE_URL = os.getenv( "DATABASE_URL", "postgresql://user:password@localhost:5432/shortener_db")REDIS_URL = os.getenv("REDIS_URL", "redis://localhost:6379/0") # üî¥ redisCACHE_TTL = int(os.getenv("CACHE_TTL", "3600")) # üî¥ redisSYNC_INTERVAL = int(os.getenv("SYNC_INTERVAL", "300")) # üî¥ redisMAX_REDIS_CONNECTIONS = int(os.getenv("REDIS_POOL_SIZE", "20")) # üî¥ redis
# DB -------------------------------------------------------------------------engine = create_engine(DATABASE_URL)SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)Base = declarative_base()

class URLModel(Base): __tablename__ = "urls" id = Column(Integer, primary_key=True, index=True) original_url = Column(String, nullable=False) short_code = Column(String, unique=True, index=True, nullable=False) created_at = Column(DateTime, default=datetime.utcnow) clicks = Column(Integer, default=0)

Base.metadata.create_all(bind=engine)
# -------------------------------------------------# Redis: build a reusable async connection-pool client# -------------------------------------------------redis_pool: redis.ConnectionPool | None = None # set on startupredis_client: redis.Redis | None = None # set on startup

# -------------------------------------------------# Pydantic# -------------------------------------------------class URLCreate(BaseModel): original_url: HttpUrl

class URLResponse(BaseModel): original_url: str short_code: str short_url: str created_at: datetime clicks: int
 class Config: from_attributes = True

# -------------------------------------------------# FastAPI# -------------------------------------------------app = FastAPI( title="URL Shortener API", description="API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫", version="1.0.0",)

# -------------------------------------------------# Helpers# -------------------------------------------------def get_db(): db = SessionLocal() try: yield db finally: db.close()

def generate_short_code(length: int = 6) -> str: return "".join( secrets.choice(string.ascii_letters + string.digits) for _ in range(length) )

# üî¥ redis ‚Äì cache keys helpersdef _clicks_key(code: str) -> str: return f"url:{code}:clicks"

def _url_key(code: str) -> str: return f"url:{code}:data"

# -------------------------------------------------# Background sync: flush cached click counts# -------------------------------------------------async def _sync_clicks_async(): assert redis_client # mypy/IDE hint while True: print("Running background sync task") await asyncio.sleep(SYNC_INTERVAL) keys = await redis_client.keys("url:*:clicks") if not keys: continue with SessionLocal() as db: for k in keys: # k format: url:<code>:clicks code = k.split(":")[1] cached_clicks_raw = await redis_client.get(k) cached_clicks = int(cached_clicks_raw or 0) if cached_clicks: row = db.query(URLModel).filter(URLModel.short_code == code).first() if row: row.clicks += cached_clicks db.add(row) db.commit() await redis_client.delete(k)

# -------------------------------------------------# Application lifespan: create & close pool# -------------------------------------------------@app.on_event("startup")async def startup_event() -> None: global redis_pool, redis_client
 # 1. Build a pool with a max connection limit redis_pool = redis.ConnectionPool.from_url( REDIS_URL, max_connections=MAX_REDIS_CONNECTIONS, decode_responses=True, )
 # 2. Build a client bound to that pool redis_client = redis.Redis(connection_pool=redis_pool) # type: ignore[arg-type]
 # 3. Launch background syncing coroutine asyncio.create_task(_sync_clicks_async())

@app.on_event("shutdown")async def shutdown_event() -> None: # Close client and pool gracefully if redis_client: await redis_client.aclose() if redis_pool: await redis_pool.aclose()

# -------------------------------------------------# End-points# -------------------------------------------------@app.get("/health")async def health_check(): return {"status": "healthy", "timestamp": datetime.utcnow()}

@app.get("/")async def root(): return { "message": "URL Shortener API", "version": "1.0.0", "endpoints": { "create": "POST /shorten", "redirect": "GET /{short_code}", "stats": "GET /stats/{short_code}", }, }

@app.post("/shorten", response_model=URLResponse)async def create_short_url(url_data: URLCreate, db: Session = Depends(get_db)): existing_url = ( db.query(URLModel) .filter(URLModel.original_url == str(url_data.original_url)) .first() ) if existing_url: base_url = os.getenv("BASE_URL", "https://yourdomain.com") return URLResponse( original_url=existing_url.original_url, short_code=existing_url.short_code, short_url=f"{base_url}/{existing_url.short_code}", created_at=existing_url.created_at, clicks=existing_url.clicks, )
 while True: short_code = generate_short_code() if not db.query(URLModel).filter(URLModel.short_code == short_code).first(): break
 db_url = URLModel(original_url=str(url_data.original_url), short_code=short_code) db.add(db_url) db.commit() db.refresh(db_url)
 # üî¥ caching a key in redis await redis_client.setex( # type: ignore[func-returns-value] _url_key(short_code), CACHE_TTL, json.dumps( { "original_url": db_url.original_url, "created_at": db_url.created_at.isoformat(), } ), )
 base_url = os.getenv("BASE_URL", "https://yourdomain.com") return URLResponse( original_url=db_url.original_url, short_code=db_url.short_code, short_url=f"{base_url}/{db_url.short_code}", created_at=db_url.created_at, clicks=db_url.clicks, )

@app.get("/{short_code}")async def redirect_to_url(short_code: str, db: Session = Depends(get_db)): # üî¥ attempting to retrieve data from redis cache_key = _url_key(short_code) cached = await redis_client.get(cache_key) # type: ignore[attr-defined] if cached: data = json.loads(cached) await redis_client.incr(_clicks_key(short_code)) # type: ignore[attr-defined] return RedirectResponse(url=data["original_url"], status_code=302)
 url_record = db.query(URLModel).filter(URLModel.short_code == short_code).first() if not url_record: raise HTTPException(status_code=404, detail="–°—Å—ã–ª–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
 # üî¥ caching a data in redis await redis_client.setex( # type: ignore[func-returns-value] cache_key, CACHE_TTL, json.dumps( { "original_url": url_record.original_url, "created_at": url_record.created_at.isoformat(), } ), ) await redis_client.incr(_clicks_key(short_code)) # type: ignore[attr-defined]
 return RedirectResponse(url=url_record.original_url, status_code=302)

@app.get("/stats/{short_code}", response_model=URLResponse)async def get_url_stats(short_code: str, db: Session = Depends(get_db)): url_record = db.query(URLModel).filter(URLModel.short_code == short_code).first() if not url_record: raise HTTPException(status_code=404, detail="–°—Å—ã–ª–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
 # üî¥ retrieving data from redis pending_raw = await redis_client.get(_clicks_key(short_code)) # type: ignore[attr-defined] pending = int(pending_raw or 0) total_clicks = url_record.clicks + pending
 base_url = os.getenv("BASE_URL", "https://yourdomain.com") return URLResponse( original_url=url_record.original_url, short_code=url_record.short_code, short_url=f"{base_url}/{url_record.short_code}", created_at=url_record.created_at, clicks=total_clicks, )

if __name__ == "__main__": import uvicorn
 uvicorn.run(app, host="0.0.0.0", port=8000)

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–∏–±—Ä–∏–¥–Ω—É—é —Å—Ö–µ–º—É —Å Managed PostgreSQL¬Æ –∏ Managed Redis¬Æ –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏, —á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É —Å–µ—Ä–≤–∏—Å–∞.
–ù–æ–≤—ã–π –∫–æ–¥, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π Redis, –æ—Ç–º–µ—á–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ —Å üî¥.
5. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª requirements.txt –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –¥–æ–±–∞–≤–∏–≤ –º–æ–¥—É–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Managed Redis¬Æ.
nano requirements.txt

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:
uvicorn[standard]==0.24.0sqlalchemy==2.0.23psycopg2-binary==2.9.9python-dotenv==1.0.0pydantic==2.5.0redis==6.2.0aioredis==2.0.1

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ redis –∏ aioredis.
6. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
pip install -r requirements.txt
7. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª .env –∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Managed Redis¬Æ –∏ Managed PostgreSQL¬Æ.
nano .env

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:
DATABASE_URL=postgresql://short_links:<PASSWORD>@<DB_PRIVATE_IP>:5432/short_linksBASE_URL=<IP-–∞–¥—Ä–µ—Å>.nip.ioREDIS_URL=redis://:<REDIS_PASSWORD>@<REDIS_IP>:6379CACHE_TTL=3600SYNC_INTERVAL=60

–ì–¥–µ:

<PASSWORD> ‚Äî –ø–∞—Ä–æ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –∑–∞–¥–∞–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Managed PostgreSQL¬Æ.
<DB_PRIVATE_IP> ‚Äî IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–∏—Å–∞ Managed PostgreSQL¬Æ.
<IP-–∞–¥—Ä–µ—Å> ‚Äî –ø—É–±–ª–∏—á–Ω—ã–π IP-–∞–¥—Ä–µ—Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã.
<REDIS_IP> ‚Äî IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–∏—Å–∞ Managed Redis¬Æ.
<REDIS_PASSWORD> ‚Äî –ø–∞—Ä–æ–ª—å –æ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∞ Managed Redis¬Æ.
8. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å short-links:
sudo systemctl daemon-reloadsudo systemctl restart short-links

[–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ short-links-service –ø–æ SSH](https://cloud.ru/docs/virtual-machines/ug/topics/guides__ssh-connection)–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ short-links-service –ø–æ SSH.

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
cd
short-links-service
```

–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

```bash
source
venv/bin/activate
```

–ó–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ —Å–µ—Ä–≤–µ—Ä–∞ server.py –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Redis.

```bash
nano
server.py
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:

```bash
import
asyncio
import
json
import
os
import
secrets
import
string
import
threading
import
time
from
datetime
import
datetime
from
dotenv
import
load_dotenv
from
fastapi
import
Depends
,
FastAPI
,
HTTPException
from
fastapi
.
responses
import
RedirectResponse
from
pydantic
import
BaseModel
,
HttpUrl
from
sqlalchemy
import
Column
,
DateTime
,
Integer
,
String
,
create_engine
from
sqlalchemy
.
orm
import
Session
,
declarative_base
,
sessionmaker
# üî¥ redis (async, pooled)
import
redis
.
asyncio
as
redis
# redis-py ‚â•5 provides asyncio & pooling
load_dotenv
(
)
# -------------------------------------------------
# Environment & external services
# -------------------------------------------------
DATABASE_URL
=
os
.
getenv
(
"DATABASE_URL"
,
"postgresql://user:password@localhost:5432/shortener_db"
)
REDIS_URL
=
os
.
getenv
(
"REDIS_URL"
,
"redis://localhost:6379/0"
)
# üî¥ redis
CACHE_TTL
=
int
(
os
.
getenv
(
"CACHE_TTL"
,
"3600"
)
)
# üî¥ redis
SYNC_INTERVAL
=
int
(
os
.
getenv
(
"SYNC_INTERVAL"
,
"300"
)
)
# üî¥ redis
MAX_REDIS_CONNECTIONS
=
int
(
os
.
getenv
(
"REDIS_POOL_SIZE"
,
"20"
)
)
# üî¥ redis
# DB -------------------------------------------------------------------------
engine
=
create_engine
(
DATABASE_URL
)
SessionLocal
=
sessionmaker
(
autocommit
=
False
,
autoflush
=
False
,
bind
=
engine
)
Base
=
declarative_base
(
)
class
URLModel
(
Base
)
:
__tablename__
=
"urls"
id
=
Column
(
Integer
,
primary_key
=
True
,
index
=
True
)
original_url
=
Column
(
String
,
nullable
=
False
)
short_code
=
Column
(
String
,
unique
=
True
,
index
=
True
,
nullable
=
False
)
created_at
=
Column
(
DateTime
,
default
=
datetime
.
utcnow
)
clicks
=
Column
(
Integer
,
default
=
0
)
Base
.
metadata
.
create_all
(
bind
=
engine
)
# -------------------------------------------------
# Redis: build a reusable async connection-pool client
# -------------------------------------------------
redis_pool
:
redis
.
ConnectionPool
|
None
=
None
# set on startup
redis_client
:
redis
.
Redis
|
None
=
None
# set on startup
# -------------------------------------------------
# Pydantic
# -------------------------------------------------
class
URLCreate
(
BaseModel
)
:
original_url
:
HttpUrl
class
URLResponse
(
BaseModel
)
:
original_url
:
str
short_code
:
str
short_url
:
str
created_at
:
datetime
clicks
:
int
class
Config
:
from_attributes
=
True
# -------------------------------------------------
# FastAPI
# -------------------------------------------------
app
=
FastAPI
(
title
=
"URL Shortener API"
,
description
=
"API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫"
,
version
=
"1.0.0"
,
)
# -------------------------------------------------
# Helpers
# -------------------------------------------------
def
get_db
(
)
:
db
=
SessionLocal
(
)
try
:
yield
db
finally
:
db
.
close
(
)
def
generate_short_code
(
length
:
int
=
6
)
-
>
str
:
return
""
.
join
(
secrets
.
choice
(
string
.
ascii_letters
+
string
.
digits
)
for
_
in
range
(
length
)
)
# üî¥ redis ‚Äì cache keys helpers
def
_clicks_key
(
code
:
str
)
-
>
str
:
return
f"url:
{
code
}
:clicks"
def
_url_key
(
code
:
str
)
-
>
str
:
return
f"url:
{
code
}
:data"
# -------------------------------------------------
# Background sync: flush cached click counts
# -------------------------------------------------
async
def
_sync_clicks_async
(
)
:
assert
redis_client
# mypy/IDE hint
while
True
:
print
(
"Running background sync task"
)
await
asyncio
.
sleep
(
SYNC_INTERVAL
)
keys
=
await
redis_client
.
keys
(
"url:*:clicks"
)
if
not
keys
:
continue
with
SessionLocal
(
)
as
db
:
for
k
in
keys
:
# k format: url:<code>:clicks
code
=
k
.
split
(
":"
)
[
1
]
cached_clicks_raw
=
await
redis_client
.
get
(
k
)
cached_clicks
=
int
(
cached_clicks_raw
or
0
)
if
cached_clicks
:
row
=
db
.
query
(
URLModel
)
.
filter
(
URLModel
.
short_code
==
code
)
.
first
(
)
if
row
:
row
.
clicks
+=
cached_clicks
db
.
add
(
row
)
db
.
commit
(
)
await
redis_client
.
delete
(
k
)
# -------------------------------------------------
# Application lifespan: create & close pool
# -------------------------------------------------
@app
.
on_event
(
"startup"
)
async
def
startup_event
(
)
-
>
None
:
global
redis_pool
,
redis_client
# 1. Build a pool with a max connection limit
redis_pool
=
redis
.
ConnectionPool
.
from_url
(
REDIS_URL
,
max_connections
=
MAX_REDIS_CONNECTIONS
,
decode_responses
=
True
,
)
# 2. Build a client bound to that pool
redis_client
=
redis
.
Redis
(
connection_pool
=
redis_pool
)
# type: ignore[arg-type]
# 3. Launch background syncing coroutine
asyncio
.
create_task
(
_sync_clicks_async
(
)
)
@app
.
on_event
(
"shutdown"
)
async
def
shutdown_event
(
)
-
>
None
:
# Close client and pool gracefully
if
redis_client
:
await
redis_client
.
aclose
(
)
if
redis_pool
:
await
redis_pool
.
aclose
(
)
# -------------------------------------------------
# End-points
# -------------------------------------------------
@app
.
get
(
"/health"
)
async
def
health_check
(
)
:
return
{
"status"
:
"healthy"
,
"timestamp"
:
datetime
.
utcnow
(
)
}
@app
.
get
(
"/"
)
async
def
root
(
)
:
return
{
"message"
:
"URL Shortener API"
,
"version"
:
"1.0.0"
,
"endpoints"
:
{
"create"
:
"POST /shorten"
,
"redirect"
:
"GET /{short_code}"
,
"stats"
:
"GET /stats/{short_code}"
,
}
,
}
@app
.
post
(
"/shorten"
,
response_model
=
URLResponse
)
async
def
create_short_url
(
url_data
:
URLCreate
,
db
:
Session
=
Depends
(
get_db
)
)
:
existing_url
=
(
db
.
query
(
URLModel
)
.
filter
(
URLModel
.
original_url
==
str
(
url_data
.
original_url
)
)
.
first
(
)
)
if
existing_url
:
base_url
=
os
.
getenv
(
"BASE_URL"
,
"https://yourdomain.com"
)
return
URLResponse
(
original_url
=
existing_url
.
original_url
,
short_code
=
existing_url
.
short_code
,
short_url
=
f"
{
base_url
}
/
{
existing_url
.
short_code
}
"
,
created_at
=
existing_url
.
created_at
,
clicks
=
existing_url
.
clicks
,
)
while
True
:
short_code
=
generate_short_code
(
)
if
not
db
.
query
(
URLModel
)
.
filter
(
URLModel
.
short_code
==
short_code
)
.
first
(
)
:
break
db_url
=
URLModel
(
original_url
=
str
(
url_data
.
original_url
)
,
short_code
=
short_code
)
db
.
add
(
db_url
)
db
.
commit
(
)
db
.
refresh
(
db_url
)
# üî¥ caching a key in redis
await
redis_client
.
setex
(
# type: ignore[func-returns-value]
_url_key
(
short_code
)
,
CACHE_TTL
,
json
.
dumps
(
{
"original_url"
:
db_url
.
original_url
,
"created_at"
:
db_url
.
created_at
.
isoformat
(
)
,
}
)
,
)
base_url
=
os
.
getenv
(
"BASE_URL"
,
"https://yourdomain.com"
)
return
URLResponse
(
original_url
=
db_url
.
original_url
,
short_code
=
db_url
.
short_code
,
short_url
=
f"
{
base_url
}
/
{
db_url
.
short_code
}
"
,
created_at
=
db_url
.
created_at
,
clicks
=
db_url
.
clicks
,
)
@app
.
get
(
"/{short_code}"
)
async
def
redirect_to_url
(
short_code
:
str
,
db
:
Session
=
Depends
(
get_db
)
)
:
# üî¥ attempting to retrieve data from redis
cache_key
=
_url_key
(
short_code
)
cached
=
await
redis_client
.
get
(
cache_key
)
# type: ignore[attr-defined]
if
cached
:
data
=
json
.
loads
(
cached
)
await
redis_client
.
incr
(
_clicks_key
(
short_code
)
)
# type: ignore[attr-defined]
return
RedirectResponse
(
url
=
data
[
"original_url"
]
,
status_code
=
302
)
url_record
=
db
.
query
(
URLModel
)
.
filter
(
URLModel
.
short_code
==
short_code
)
.
first
(
)
if
not
url_record
:
raise
HTTPException
(
status_code
=
404
,
detail
=
"–°—Å—ã–ª–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
)
# üî¥ caching a data in redis
await
redis_client
.
setex
(
# type: ignore[func-returns-value]
cache_key
,
CACHE_TTL
,
json
.
dumps
(
{
"original_url"
:
url_record
.
original_url
,
"created_at"
:
url_record
.
created_at
.
isoformat
(
)
,
}
)
,
)
await
redis_client
.
incr
(
_clicks_key
(
short_code
)
)
# type: ignore[attr-defined]
return
RedirectResponse
(
url
=
url_record
.
original_url
,
status_code
=
302
)
@app
.
get
(
"/stats/{short_code}"
,
response_model
=
URLResponse
)
async
def
get_url_stats
(
short_code
:
str
,
db
:
Session
=
Depends
(
get_db
)
)
:
url_record
=
db
.
query
(
URLModel
)
.
filter
(
URLModel
.
short_code
==
short_code
)
.
first
(
)
if
not
url_record
:
raise
HTTPException
(
status_code
=
404
,
detail
=
"–°—Å—ã–ª–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
)
# üî¥ retrieving data from redis
pending_raw
=
await
redis_client
.
get
(
_clicks_key
(
short_code
)
)
# type: ignore[attr-defined]
pending
=
int
(
pending_raw
or
0
)
total_clicks
=
url_record
.
clicks
+
pending
base_url
=
os
.
getenv
(
"BASE_URL"
,
"https://yourdomain.com"
)
return
URLResponse
(
original_url
=
url_record
.
original_url
,
short_code
=
url_record
.
short_code
,
short_url
=
f"
{
base_url
}
/
{
url_record
.
short_code
}
"
,
created_at
=
url_record
.
created_at
,
clicks
=
total_clicks
,
)
if
__name__
==
"__main__"
:
import
uvicorn
uvicorn
.
run
(
app
,
host
=
"0.0.0.0"
,
port
=
8000
)
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–∏–±—Ä–∏–¥–Ω—É—é —Å—Ö–µ–º—É —Å Managed PostgreSQL¬Æ –∏ Managed Redis¬Æ –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏, —á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É —Å–µ—Ä–≤–∏—Å–∞.
–ù–æ–≤—ã–π –∫–æ–¥, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π Redis, –æ—Ç–º–µ—á–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ —Å üî¥.

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª requirements.txt –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –¥–æ–±–∞–≤–∏–≤ –º–æ–¥—É–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Managed Redis¬Æ.

```bash
nano
requirements.txt
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:

```bash
uvicorn
[
standard
]
==
0.24
.0
sqlalchemy
==
2.0
.23
psycopg2-binary
==
2.9
.9
python-dotenv
==
1.0
.0
pydantic
==
2.5
.0
redis
==
6.2
.0
aioredis
==
2.0
.1
```

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ redis –∏ aioredis.

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip
install
-r
requirements.txt
```

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª .env –∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Managed Redis¬Æ –∏ Managed PostgreSQL¬Æ.

```bash
nano
.env
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:

```bash
DATABASE_URL
=
postgresql://short_links:
<
PASSWORD
>
@
<
DB_PRIVATE_IP
>
:5432/short_links
BASE_URL
=
<
IP-–∞–¥—Ä–µ—Å
>
.nip.io
REDIS_URL
=
redis://:
<
REDIS_PASSWORD
>
@
<
REDIS_IP
>
:6379
CACHE_TTL
=
3600
SYNC_INTERVAL
=
60
```

–ì–¥–µ:

- <PASSWORD> ‚Äî –ø–∞—Ä–æ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –∑–∞–¥–∞–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Managed PostgreSQL¬Æ.
- <DB_PRIVATE_IP> ‚Äî IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–∏—Å–∞ Managed PostgreSQL¬Æ.
- <IP-–∞–¥—Ä–µ—Å> ‚Äî –ø—É–±–ª–∏—á–Ω—ã–π IP-–∞–¥—Ä–µ—Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã.
- <REDIS_IP> ‚Äî IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–∏—Å–∞ Managed Redis¬Æ.
- <REDIS_PASSWORD> ‚Äî –ø–∞—Ä–æ–ª—å –æ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∞ Managed Redis¬Æ.

<PASSWORD> ‚Äî –ø–∞—Ä–æ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –∑–∞–¥–∞–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Managed PostgreSQL¬Æ.

<DB_PRIVATE_IP> ‚Äî IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–∏—Å–∞ Managed PostgreSQL¬Æ.

<IP-–∞–¥—Ä–µ—Å> ‚Äî –ø—É–±–ª–∏—á–Ω—ã–π IP-–∞–¥—Ä–µ—Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã.

<REDIS_IP> ‚Äî IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–∏—Å–∞ Managed Redis¬Æ.

<REDIS_PASSWORD> ‚Äî –ø–∞—Ä–æ–ª—å –æ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∞ Managed Redis¬Æ.

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å short-links:

```bash
sudo
systemctl daemon-reload
sudo
systemctl restart short-links
```

## 5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –ø—Ä–æ–≤–µ–¥–∏—Ç–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ç–µ—Å—Ç –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –∫–æ–º–∞–Ω–¥–æ–π:
k6 run short-links.test.js
2. –î–æ–∂–¥–∏—Ç–µ—Å—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
‚ñà TOTAL RESULTS
 checks_total.......................: 8690 141.794978/s checks_succeeded...................: 100.00% 8690 out of 8690 checks_failed......................: 0.00% 0 out of 8690
 ‚úì create - status 201/200 ‚úì create - has short_code ‚úì redirect status 302/301
 HTTP http_req_duration.......................................................: avg=24.59ms min=10.53ms med=17.39ms max=3.04s p(90)=23.72ms p(95)=61.7ms { expected_response:true }............................................: avg=24.59ms min=10.53ms med=17.39ms max=3.04s p(90)=23.72ms p(95)=61.7ms http_req_failed.........................................................: 0.00% 0 out of 8295 http_reqs...............................................................: 8295 135.349752/s
 EXECUTION iteration_duration......................................................: avg=1.52s min=1.25s med=1.48s max=5.44s p(90)=1.52s p(95)=1.55s iterations..............................................................: 395 6.445226/s vus.....................................................................: 1 min=1 max=10 vus_max.................................................................: 10 min=10 max=10
 NETWORK data_received...........................................................: 1.8 MB 30 kB/s data_sent...............................................................: 946 kB 15 kB/s
running (1m01.3s), 00/10 VUs, 395 complete and 0 interrupted iterationsshortener_flow ‚úì [======================================] 10 VUs 1m0s

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –∫–æ–º–∞–Ω–¥–æ–π:

```bash
k6 run short-links.test.js
```

–î–æ–∂–¥–∏—Ç–µ—Å—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:

```bash
‚ñà TOTAL RESULTS
checks_total
..
..
..
..
..
..
..
..
..
..
..
.:
8690
141.794978
/s
checks_succeeded
..
..
..
..
..
..
..
..
..
.:
100.00
%
8690
out of
8690
checks_failed
..
..
..
..
..
..
..
..
..
..
..
:
0.00
%
0
out of
8690
‚úì create - status
201
/200
‚úì create - has short_code
‚úì redirect status
302
/301
HTTP
http_req_duration
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
avg
=
24
.59ms
min
=
10
.53ms
med
=
17
.39ms
max
=
3
.04s p
(
90
)
=
23
.72ms p
(
95
)
=
61
.7ms
{
expected_response:true
}
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
:
avg
=
24
.59ms
min
=
10
.53ms
med
=
17
.39ms
max
=
3
.04s p
(
90
)
=
23
.72ms p
(
95
)
=
61
.7ms
http_req_failed
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
0.00
%
0
out of
8295
http_reqs
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
8295
135.349752
/s
EXECUTION
iteration_duration
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
:
avg
=
1
.52s
min
=
1
.25s
med
=
1
.48s
max
=
5
.44s p
(
90
)
=
1
.52s p
(
95
)
=
1
.55s
iterations
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
:
395
6.445226
/s
vus
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
1
min
=
1
max
=
10
vus_max
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
10
min
=
10
max
=
10
NETWORK
data_received
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
1.8
MB
30
kB/s
data_sent
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
..
.:
946
kB
15
kB/s
running
(
1m01.3s
)
, 00/10 VUs,
395
complete and
0
interrupted iterations
shortener_flow ‚úì
[
==
==
==
==
==
==
==
==
==
==
==
==
==
==
==
==
==
==
==
]
10
VUs 1m0s
```

–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ç–µ—Å—Ç–æ–º –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ —Å–æ–∫—Ä–∞—Ç–∏–ª–æ—Å—å —Å 370.01 –º—Å –¥–æ 24.59 –º—Å, –∞ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∏—Ç–µ—Ä–∞—Ü–∏–∏ ‚Äî —Å 8.78 —Å –¥–æ 1.52 —Å.

## 6. –£–¥–∞–ª–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ k6-load-test –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–∞.

[–£–¥–∞–ª–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É k6-load-test](https://cloud.ru/docs/virtual-machines/ug/topics/guides__delete-vm)–£–¥–∞–ª–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É k6-load-test —É–±–µ–¥–∏–≤—à–∏—Å—å, —á—Ç–æ –æ—Ç–º–µ—á–µ–Ω—ã:

1. –î–∏—Å–∫–∏.
2. –ü—É–±–ª–∏—á–Ω—ã–π IP.

–î–∏—Å–∫–∏.

–ü—É–±–ª–∏—á–Ω—ã–π IP.

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –≤ —Å–µ—Ä–≤–∏—Å–µ ¬´–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã¬ª –±–æ–ª—å—à–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ k6-load-test.

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–í—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏ –æ—Ü–µ–Ω–∏–ª–∏ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
