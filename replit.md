# AI-Репетитор по техническим дисциплинам

## Обзор проекта

AI-репетитор на основе RAG-подхода (Retrieval Augmented Generation) для помощи студентам в изучении облачных технологий Cloud.ru. Проект разработан в рамках хакатона Cloud.ru.

## Архитектура

### Компоненты системы

1. **Document Loader** (`document_loader.py`)
   - Загрузка markdown документов из базы знаний
   - Извлечение метаданных из YAML frontmatter
   - Разбиение документов на чанки для индексации

2. **RAG Engine** (`rag_engine.py`)
   - Векторизация документов с помощью OpenAI Embeddings
   - Хранение и поиск векторов в FAISS
   - Генерация ответов с использованием GPT-4o
   - Функция генерации вопросов для самопроверки

3. **Web Interface** (`app.py`)
   - Streamlit чат-интерфейс
   - Отображение источников в ответах
   - Режим самопроверки с генерацией вопросов
   - История диалога

### Структура проекта

```
├── app.py                  # Главное Streamlit приложение
├── rag_engine.py          # RAG движок с OpenAI
├── document_loader.py     # Загрузчик документов
├── knowledge_base/        # База знаний (markdown файлы)
│   └── cloudru/
│       ├── ai-factory/
│       ├── database/
│       ├── containers/
│       ├── network/
│       └── ...
├── vector_store/          # Сохранённый FAISS индекс
└── .streamlit/config.toml # Конфигурация Streamlit
```

## Запуск приложения

```bash
streamlit run app.py --server.port 5000
```

## Необходимые секреты

- `OPENAI_API_KEY` - API ключ OpenAI для эмбеддингов и генерации ответов

## Технологический стек

- **Python 3.11**
- **Streamlit** - веб-интерфейс
- **LangChain** - RAG пайплайн
- **FAISS** - векторный поиск
- **OpenAI GPT-4o** - генерация ответов
- **OpenAI text-embedding-3-small** - векторизация

## Функциональность

- Чат с AI-репетитором по техническим темам
- Поиск релевантной информации в базе знаний
- Отображение источников использованной информации
- Генерация вопросов для самопроверки
- История диалога в рамках сессии

## Безопасность, логирование и мониторинг

### Логирование (`logger.py`)
- Структурированное JSON-логирование в файл `app.log` и консоль
- Логирование запросов, ответов, ошибок с метаданными
- Автоматическое скрытие технических деталей ошибок от пользователя

### Валидация ввода
- Проверка длины запроса (2-2000 символов)
- Защита от пустых и слишком коротких запросов
- Безопасные сообщения об ошибках без технических деталей

### Метрики (`MetricsCollector`)
- Счётчик запросов и ошибок
- Среднее время ответа
- Счётчик нарушений контент-фильтра

### Контент-фильтрация
- Блокировка политических и географических тем
- Блокировка запросов о смене роли AI
- Фильтрация нецензурной лексики

## Темы базы знаний

- AI Factory (Managed RAG, Foundation Models, ML)
- Базы данных (PostgreSQL, Redis)
- Контейнеры (Kubernetes)
- Брокеры сообщений (Kafka, Spark)
- Сети (VPN, VPC)
- Мониторинг и логирование

## Масштабируемость

### Добавление новых предметов

Для добавления нового предмета:
1. Создайте папку в `knowledge_base/` (например, `knowledge_base/physics/`)
2. Добавьте markdown файлы с учебными материалами
3. Добавьте запись в `knowledge_bases.json`:
   ```json
   {
     "id": "physics",
     "name": "Физика",
     "path": "knowledge_base/physics",
     "enabled": true,
     "description": "Курс физики"
   }
   ```
4. Перезапустите приложение

### Конфигурация баз знаний

Файл `knowledge_bases.json` содержит список доступных баз знаний:
- `id` - уникальный идентификатор
- `name` - отображаемое имя
- `path` - путь к папке с документами
- `enabled` - доступна ли база для выбора
- `description` - описание
